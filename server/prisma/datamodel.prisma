## Schema involving Person and User types are likely going to change
## as we understand more about the production schema.

## Assume that User will have a string identifier passed from OKTA
## As well as a claims array containing a list of strings.

type User {
  id: ID! @id
  name: String!
}

type Program {
  id: ID! @id
  name: String!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
  products: [Product]!
}

type Product {
  id: ID! @id
  name: String!
  program: Program!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
  projects: [Project]!
}

type Project {
  id: ID! @id
  name: String!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
  start: DateTime!
  end: DateTime!
  product: Product!
  notes: [ProjectNote!]!
  projectRoles: [ProjectRole]!
}

## Need to create an intermediate type
## See: https://github.com/prisma/prisma/issues/1907

type ProjectNote {
  id: ID! @id
  meetingAttendees: [Person!]!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
  note: Note! @relation(link: TABLE)
}

type Note {
  id: ID! @id
  project: Project!
  projectNote: ProjectNote!
  author: Person!
  title: String!
  content: String!
  performanceRating: Rating!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

enum Rating {
  LOW
  MEDIUM
  HIGH
}

type Role {
  id: ID! @id
  title: String!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type ProjectRole {
  id: ID! @id
  person: Person!
  project: Project!
  role: Role!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type ProductRole {
  id: ID! @id
  person: Person!
  product: Product!
  role: Role!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type ProgramRole {
  id: ID! @id
  person: Person!
  program: Program!
  role: Role!
  createdAt: DateTime! @createdAt
  updatedAt: DateTime! @updatedAt
}

type Person {
  id: ID! @id
  name: String!
  program: Program!
  email: String!
  githubId: String!
  slackId: String!
  avatarURL: String!
  timeZone: TimeZone!
  notes: [Note!]!
  meetingsAttended: [ProjectNote!]!
}

enum TimeZone {
  PST
  CST
  EST
}
